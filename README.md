# SPQR for spatial extremes

## HCDN Folder
This folder contains details of all the stations in the network (as a .csv and .xlsx file) as well as <code>HCDN_annual_max.RData</code> which has data on the 702 locations for 1950 -- 2021.

## <code>download_annual_max.R</code>
Contains code for downloading the annual extremal streamflow data used in this study. Will generate all the variables needed for the <code>HCDN_annual_max.RData</code> file.

## <code>SPQR_fit_stratified.R</code>
Contains the SPQR code for the entire study. Note that each location of the SPQR is meant to generate 2 files (which can be used to obtain model fit diagnostics), whose total size is approximately 30mb. These output files have not been provided in the repository due to their cumulative volume.

## <code>simGPave_local_parallel_HUC02.R</code>
Frontend for the MCMC that is used to obtain paramter estimates. A code block is commented out early on in the code which is meant to read in the SPQR objects generated by  <code>SPQR_fit_stratified.R</code> and converts its contents into an array of neural network weights. Instead, the array with the weights is supplied as a separate object, <code>fitted_SPQR_models.RData</code>, that is imported in the beginning of the file.

## <code>MCMC_veccia_approx_HUC02_SVC.R</code>
This file is called by <code>simGPave_local_parallel_HUC02.R</code>, and contains the actual MCMC codes that are used in our study.

## <code>gen_data.R</code>
Contains utility functions for generating data from the process mixture model. Also contains functions for generating data for the GP and process mixture model simulation studies that are presented in the paper.

## <code>gev_mle.R</code>
Generates the initial maximum likelihood estimates for the GEV parameters, the empirical variograms for each parameter's MLEs, and their corresponding plots that are presented in Section 5 of the paper.

## <code>joint_exceedance.R</code>
Contains code for the analysis on the 7 sites in Colorado that is presented at the end of Section 5. The code requires the entire MCMC output (<code>MCMC_outputs.RData</code>). This file is currently not provided in the repository because of size constraints, but can be generated by running <code>simGPave_local_parallel_HUC02.R</code>

## <code>maps_GEV.R</code>
Contains code to plot the posterior means of the GEV parameters. The code requires the entire MCMC output (<code>MCMC_outputs.RData</code>). This file is currently not provided in the repository because of size constraints, but can be generated by running <code>simGPave_local_parallel_HUC02.R</code>

## <code>ranges_HUC02.R</code>
Contains code to generate exploratory plots used throughout the study.

## <code>utils_MSP.R</code>
Contains code pertaining to working with the process mixture model distribution.
